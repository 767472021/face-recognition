# face-recognition
Perform face recognition in video stream for registered members. This repo is based on https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/

# Installation
## Prerequisite
The python scripts are written for Python 3 only and requires the following modules <br>
1. opencv-python
2. imutils
3. sklearn
4. numpy
5. tkinter

## How to run
`$ python3 main.py`



## Understanding the files and directories
1. `dataset` <br> 
It consists of all the images from all registered members + `unknown`.
All images are named from `0000` to `9999`. At the beginning, you should only see the following
    ```
    dataset
    └── unknown
        ├── 0000.png
        ├── 0001.png
        ├── 0002.png
        ├── 0003.png
        └── 0004.png
    ```
where the images are generated by some GANs.<br><br>


2. `embeddings` <br>
    It consists of the embedding model and data of 128-d vectors
    - `embeddings.pickle` is the serialized Python dictionary with keys being the image paths, and values being 128-d vectors
    - `embeddings/data/individual/<identity>/embeddings.pickle` stores the 128-d vectors
      corresponds to that <identity>
    - `embeddings/data/overall/embeddings.pickle` stores the 128-d vectors of ALL <identity>
    - `openface_nn4.small2.v1.t7` is the pre-trained FaceNet CNN to extract 128-d vectors from a face
    ```
    embeddings
    ├── data
    │   ├── individual
    │   │   └── unknown
    │   │       └── embeddings.pickle
    │   └── overall
    │       └── embeddings.pickle
    └── model
        └── openface_nn4.small2.v1.t7
    ```
    <br><br>

3. `face_detection_model`<br>
    It consists of the pre-trained model which is used to locate the face candidates from an image
    - deploy.prototxt is the architecture of the CNN.
    - res10_300x300_ssd_iter_140000.caffemodel is the pre-trained weights of this CNN.
    ```
    face_detection_model
    ├── deploy.prototxt
    └── res10_300x300_ssd_iter_140000.caffemodel
    ```
    <br><br>

4. `face_recognition_model`<br>
    It *will* consist of trained face recognition model
    - label.pickle is the serialized encoding of the identity
    - model.pickle is the serialized model<br>
    ```
    face_recognition_model
    ├── knn
    ├── rf
    └── svm
    ```
Rightnow, the sub-directories `knn` (k-Nearest Neighbour), `rf` (Random Forest), and `svm` (Support Vector Machine) are empty.
The `label.pickle` and `model.pickle` files will be generated when the number of registered member > 0.<br><br>

5. `result`<br>
    It consists of manually captured images when performing face recognition from video stream 
    using various face recognition method. Rightnow, the sub-directories are empty.
    ```
    result
    ├── cosine
    ├── knn
    ├── l1
    ├── l2
    ├── pearson
    ├── rf
    └── svm
    ```
